Public Class fdlgInformaClienteVenda
    Public Foco As String
    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        If Foco = "C" Then
            tbCliente.Text &= "1"
            tbCliente.Focus()
        Else
            tbObs.Text &= "1"
            tbObs.Focus()
        End If

    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        If Foco = "C" Then
            tbCliente.Text &= "2"
            tbCliente.Focus()
        Else
            tbObs.Text &= "2"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        If Foco = "C" Then
            tbCliente.Text &= "3"
            tbCliente.Focus()
        Else
            tbObs.Text &= "3"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        If Foco = "C" Then
            tbCliente.Text &= "4"
            tbCliente.Focus()
        Else
            tbObs.Text &= "4"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button5_Click(sender As Object, e As EventArgs) Handles Button5.Click
        If Foco = "C" Then
            tbCliente.Text &= "5"
            tbCliente.Focus()
        Else
            tbObs.Text &= "5"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        If Foco = "C" Then
            tbCliente.Text &= "6"
            tbCliente.Focus()
        Else
            tbObs.Text &= "6"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        If Foco = "C" Then
            tbCliente.Text &= "7"
            tbCliente.Focus()
        Else
            tbObs.Text &= "7"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        If Foco = "C" Then
            tbCliente.Text &= "8"
            tbCliente.Focus()
        Else
            tbObs.Text &= "8"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        If Foco = "C" Then
            tbCliente.Text &= "9"
            tbCliente.Focus()
        Else
            tbObs.Text &= "9"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button10_Click(sender As Object, e As EventArgs) Handles Button10.Click
        If Foco = "C" Then
            tbCliente.Text &= "0"
            tbCliente.Focus()
        Else
            tbObs.Text &= "0"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button16_Click(sender As Object, e As EventArgs) Handles Button16.Click
        If Foco = "C" Then
            tbCliente.Text &= "Q"
            tbCliente.Focus()
        Else
            tbObs.Text &= "Q"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button15_Click(sender As Object, e As EventArgs) Handles Button15.Click
        If Foco = "C" Then
            tbCliente.Text &= "W"
            tbCliente.Focus()
        Else
            tbObs.Text &= "W"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button14_Click(sender As Object, e As EventArgs) Handles Button14.Click
        If Foco = "C" Then
            tbCliente.Text &= "E"
            tbCliente.Focus()
        Else
            tbObs.Text &= "E"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button19_Click(sender As Object, e As EventArgs) Handles Button19.Click
        If Foco = "C" Then
            tbCliente.Text &= "R"
            tbCliente.Focus()
        Else
            tbObs.Text &= "R"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button18_Click(sender As Object, e As EventArgs) Handles Button18.Click
        If Foco = "C" Then
            tbCliente.Text &= "T"
            tbCliente.Focus()
        Else
            tbObs.Text &= "T"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button17_Click(sender As Object, e As EventArgs) Handles Button17.Click
        If Foco = "C" Then
            tbCliente.Text &= "Y"
            tbCliente.Focus()
        Else
            tbObs.Text &= "Y"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button22_Click(sender As Object, e As EventArgs) Handles Button22.Click
        If Foco = "C" Then
            tbCliente.Text &= "U"
            tbCliente.Focus()
        Else
            tbObs.Text &= "U"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button21_Click(sender As Object, e As EventArgs) Handles Button21.Click
        If Foco = "C" Then
            tbCliente.Text &= "I"
            tbCliente.Focus()
        Else
            tbObs.Text &= "I"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button20_Click(sender As Object, e As EventArgs) Handles Button20.Click
        If Foco = "C" Then
            tbCliente.Text &= "O"
            tbCliente.Focus()
        Else
            tbObs.Text &= "O"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button13_Click(sender As Object, e As EventArgs) Handles Button13.Click
        If Foco = "C" Then
            tbCliente.Text &= "P"
            tbCliente.Focus()
        Else
            tbObs.Text &= "P"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button26_Click(sender As Object, e As EventArgs) Handles Button26.Click
        If Foco = "C" Then
            tbCliente.Text &= "A"
            tbCliente.Focus()
        Else
            tbObs.Text &= "A"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button25_Click(sender As Object, e As EventArgs) Handles Button25.Click
        If Foco = "C" Then
            tbCliente.Text &= "S"
            tbCliente.Focus()
        Else
            tbObs.Text &= "S"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button24_Click(sender As Object, e As EventArgs) Handles Button24.Click
        If Foco = "C" Then
            tbCliente.Text &= "D"
            tbCliente.Focus()
        Else
            tbObs.Text &= "D"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button29_Click(sender As Object, e As EventArgs) Handles Button29.Click
        If Foco = "C" Then
            tbCliente.Text &= "F"
            tbCliente.Focus()
        Else
            tbObs.Text &= "F"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button28_Click(sender As Object, e As EventArgs) Handles Button28.Click
        If Foco = "C" Then
            tbCliente.Text &= "G"
            tbCliente.Focus()
        Else
            tbObs.Text &= "G"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button27_Click(sender As Object, e As EventArgs) Handles Button27.Click
        If Foco = "C" Then
            tbCliente.Text &= "H"
            tbCliente.Focus()
        Else
            tbObs.Text &= "H"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button32_Click(sender As Object, e As EventArgs) Handles Button32.Click
        If Foco = "C" Then
            tbCliente.Text &= "J"
            tbCliente.Focus()
        Else
            tbObs.Text &= "J"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button31_Click(sender As Object, e As EventArgs) Handles Button31.Click
        If Foco = "C" Then
            tbCliente.Text &= "K"
            tbCliente.Focus()
        Else
            tbObs.Text &= "K"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button30_Click(sender As Object, e As EventArgs) Handles Button30.Click
        If Foco = "C" Then
            tbCliente.Text &= "L"
            tbCliente.Focus()
        Else
            tbObs.Text &= "L"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button11_Click(sender As Object, e As EventArgs) Handles Button11.Click
        If Foco = "C" Then
            tbCliente.Text = ""
            tbCliente.Focus()
        Else
            tbObs.Text = ""
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button35_Click(sender As Object, e As EventArgs) Handles Button35.Click
        If Foco = "C" Then
            tbCliente.Text &= "Z"
            tbCliente.Focus()
        Else
            tbObs.Text &= "Z"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button34_Click(sender As Object, e As EventArgs) Handles Button34.Click
        If Foco = "C" Then
            tbCliente.Text &= "X"
            tbCliente.Focus()
        Else
            tbObs.Text &= "X"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button33_Click(sender As Object, e As EventArgs) Handles Button33.Click
        If Foco = "C" Then
            tbCliente.Text &= "C"
            tbCliente.Focus()
        Else
            tbObs.Text &= "C"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button38_Click(sender As Object, e As EventArgs) Handles Button38.Click
        If Foco = "C" Then
            tbCliente.Text &= "V"
            tbCliente.Focus()
        Else
            tbObs.Text &= "V"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button37_Click(sender As Object, e As EventArgs) Handles Button37.Click
        If Foco = "C" Then
            tbCliente.Text &= "B"
            tbCliente.Focus()
        Else
            tbObs.Text &= "B"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button36_Click(sender As Object, e As EventArgs) Handles Button36.Click
        If Foco = "C" Then
            tbCliente.Text &= "N"
            tbCliente.Focus()
        Else
            tbObs.Text &= "N"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button41_Click(sender As Object, e As EventArgs) Handles Button41.Click
        If Foco = "C" Then
            tbCliente.Text &= "M"
            tbCliente.Focus()
        Else
            tbObs.Text &= "M"
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button23_Click(sender As Object, e As EventArgs) Handles Button23.Click
        If Foco = "C" Then
            tbCliente.Text &= " "
            tbCliente.Focus()
        Else
            tbObs.Text &= " "
            tbObs.Focus()
        End If
    End Sub

    Private Sub Button12_Click(sender As Object, e As EventArgs) Handles Button12.Click
        If Foco = "C" Then
            tbCliente.Text &= "/"
            tbCliente.Focus()
        Else
            tbObs.Text &= "/"
            tbObs.Focus()
        End If
    End Sub

    Private Sub BtnConfirma_Click(sender As Object, e As EventArgs) Handles btnConfirma.Click

        If NuloString(tbCliente.Text) <> "" Then
            strSql = "Select tblVendas.IDVenda, tblVendas.NumMesa, tblVendas.NomeCliente, tblVendas.Excluido, tblVendas.StatusVenda, tblVendas.FlagFechada, SUM(tblVendasMovto.Qtd * tblVendasMovto.VendaServico) As VlrConsumo, tblVendas.DataVenda "
            strSql += "From tblVendas LEFT OUTER Join tblVendasMovto On tblVendas.IDVenda = tblVendasMovto.IDVenda "
            strSql += "Group By tblVendas.IDVenda, tblVendas.NumMesa, tblVendas.NomeCliente, tblVendas.StatusVenda, tblVendas.FlagFechada, tblVendas.Excluido, tblVendas.DataVenda "
            strSql += "HAVING(tblVendas.StatusVenda = 'B' OR  tblVendas.StatusVenda = 'S') AND (tblVendas.NumMesa <> 0) AND (tblVendas.FlagFechada = 0) AND (tblVendas.Excluido = 0) And (NomeCliente = '" & NuloString(tbCliente.Text) & "') "
            If NuloInteger(PegaValorCampo("IDVenda", strSql, strCon)) <> 0 And NuloInteger(PegaValorCampo("IDVenda", strSql, strCon)) <> NuloInteger(tbIDVenda.Text) Then
                Dim frm As fdlgMensagemBox = New fdlgMensagemBox
                frm.lbMensagem.Text = "Já existe uma venda vinculada a este nome " & UCase(tbCliente.Text)
                frm.btnNao.Visible = False
                frm.btnSim.Visible = False
                frm.btnOK.Visible = True
                frm.PictureBox.Image = GourmetVisual.My.Resources.Resources.exclamacao
                frm.ShowDialog()
                tbCliente.Text = ""
                Exit Sub
            End If
        End If

        strSql = "UPDATE tblVendas Set "
        strSql &= "NomeCliente='" & NuloString(UCase(tbCliente.Text)) & "', "
        strSql &= "Obs='" & NuloString(UCase(tbObs.Text)) & "' "
        strSql &= "WHERE (IDVenda=" & tbIDVenda.Text & ")"
        ExecutaStr(strSql)

        Me.Dispose()
        Me.Close()
    End Sub

    Private Sub tbCliente_KeyDown(sender As Object, e As KeyEventArgs) Handles tbCliente.KeyDown
        Select Case e.KeyCode
            Case Keys.KeyCode.Enter
                Me.InvokeOnClick(btnConfirma, e)

        End Select
    End Sub

    Private Sub TbCliente_TextChanged(sender As Object, e As EventArgs) Handles tbCliente.TextChanged

        lbCarac.Text = Len(tbCliente.Text) & " / 25"
        If Len(tbCliente.Text) > 25 Then
            Dim frm As fdlgMensagemBox = New fdlgMensagemBox
            frm.lbMensagem.Text = "Maximo 25 caracteres"
            frm.btnNao.Visible = False
            frm.btnSim.Visible = False
            frm.btnOK.Visible = True
            frm.PictureBox.Image = GourmetVisual.My.Resources.Resources.exclamacao
            frm.ShowDialog()
            tbCliente.Text = Strings.Left(tbCliente.Text, 25)
        End If
    End Sub

    Private Sub fdlgInformaClienteVenda_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        Foco = "C"
    End Sub

    Private Sub tbObs_KeyDown(sender As Object, e As KeyEventArgs) Handles tbObs.KeyDown
        Select Case e.KeyCode
            Case Keys.KeyCode.Enter
                Me.InvokeOnClick(btnConfirma, e)

        End Select
    End Sub

    Private Sub tbCliente_Enter(sender As Object, e As EventArgs) Handles tbCliente.Enter
        Foco = "C"
    End Sub

    Private Sub tbObs_Enter(sender As Object, e As EventArgs) Handles tbObs.Enter
        Foco = "O"
    End Sub
End Class